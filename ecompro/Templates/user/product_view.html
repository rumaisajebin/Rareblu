{% extends 'user/base.html' %}
{% block main %}
<div class="container">
    <div class="row align-items-center">
        <!-- Main Image -->
        <div class="col-md-4">
            <div class="card">
                <img src="{{ product.img1.url }}" class="card-img main-img" alt="Main Image"
                    style="height: 420px; width: 430px;">
                <hr>
                <div class="row">
                    {% for image_field in image_fields %}
                    <div class="col-md-3">
                        <img src="{{ image_field.url }}" alt="Product Image" data-main-img="{{ image_field.url }}"
                            class="thumbnail-img" style="width: 100%; cursor: pointer;">
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        <!-- Product Details -->
        <div class="col-md-8 my-5">
            <div class="card-body">
                <table class="table">
                    <tbody>
                        <tr>
                            <td><b>Product Name</b></td>
                            <td><b>{{ product.Product_Name }}</b></td>
                        </tr>
                        <tr>
                            <td><b>Brand</b></td>
                            <td>{{ product.Brand }}</td>
                        </tr>
                        <tr>
                            <td><b>Category</b></td>
                            <td>{{ product.Category }}</td>
                        </tr>
                        {% if category_offers %}
                        <tr>
                            <td><b>Category Offer</b></td>
                            <td>
                                {% for offer in category_offers %}
                                {{ offer.percent_offer }}% offer valid from {{ offer.start_date }} to {{offer.end_date}}
                                {% endfor %}
                            </td>
                        </tr>
                        {% endif %}
                        <tr>
                            <td><b>Price</b></td>
                            <td>
                                {% if discounted_price %}
                                <p>Original Price : ₹ {{ original_price }}</p>
                                <p>Offer Price : ₹ {{ discounted_price }}</p>
                                {% else %}
                                <p>Price : ₹ {{ original_price }}</p>
                                <p>No offer available </p>
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td><b>Stock</b></td>
                            <td>
                                {% if product.Stock >= 0 %}
                                <span class="text-danger"> In Stock</span>
                                {% else %}
                                <span class="text-danger">Out of Stock</span>
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td><b>Description</b></td>
                            <td>{{ product.Description }}</td>
                        </tr>
                    </tbody>
                </table>
                <td>
                    <a class="btn btn-success mt-2" href="{% url 'add_to_cart' product.id %}">Add to Cart</a>
                    <!-- <a href="{% url 'checkout' %}" class="btn btn-success mt-2"> Buy Now </a> -->
                    <a href="{% url 'add_to_wishlist' product.id %}" class="btn btn-success mt-2"> Add to Wishlist </a>

                </td>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@sai1253/driftjs@1.0.0/dist/Drift.min.js"></script>
<script>
    const thumbnails = document.querySelectorAll('.thumbnail-img');
    const mainImg = document.querySelector('.main-img');

    thumbnails.forEach(thumbnail => {
        thumbnail.addEventListener('click', () => {
            const newImgSrc = thumbnail.getAttribute('data-main-img');
            mainImg.src = newImgSrc;
            // Activate Drift for the updated main image
            new Drift(mainImg, {
                paneContainer: document.querySelector('.card'),
                inlinePane: 900,
                inlineOffsetY: -85,
                containInline: true,
                hoverBoundingBox: true
            });
        });
    });
</script>
{% endblock main %}